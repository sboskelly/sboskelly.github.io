
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>bob | βяąd3</title>
        <meta name="viewport" content="width=device-width">


        <!-- Bootstrap CSS -->
        
    	<link rel="stylesheet" href="/css/bootstrap.css">    	
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <link href="/css/syntax.css" rel="stylesheet">
 
    </head>


     
     <body>

<div class="container">         
	<h1 class="title">bob | βяąd3</h1>


<nav class="navbar navbar-default" role="navigation">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>      
    </button>



    <a class="navbar-brand" href="http://p00gz.github.io">Home</a>
  </div>

  <!-- Collect the nav links, forms, and other content for toggling -->
  
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">
    
      <li><a href="/archive">Archive</a></li>
    
      <li><a href="/oer">OER's</a></li>
      <li><a href="/mooc">Mooc's</a></li>
      <li><a href="/cuv">CV</a></li>
        
        <li><a href="https://github.com/p00gz">Github</a></li>
        <li><a href="https://twitter.com/p00gz">Follow @p00gz</a></li>
    </ul>
  
   
  </div><!-- /.navbar-collapse -->
</nav>




<div class="row">
  <div class="col-md-8">

          
    <h4>01-17-2014</h4>
<h2>Docker + Drupal + Amazon EC2</h2>

    <p>
    	<p><br>
<img src=" /assets/homepage-docker-logo.png" height="150"  hspace="30"> 
<img src=" /assets/druplicon.large_.png" height="150" hspace="30">
<img src=" /assets/amazon_300.png" height="150" hspace="30"></p>

<p><br>
<h4>
A Whale walks into a bookstore and wants to read up on some Drupal. </h4></p>

<p><br>
<p class="lead">
For my obligatory first post i am going to walk through my experience running a turnkey dockerized
Drupal container on an Amazon EC2 instance.
</p>
First things first, you need to create an account with Amazon AWS. The free tier is 
available for a full year and you get 750 hours of micro instances a month. 
You will need a credit card to sign up.<br>
Head over to: 
<p class="lead">
<i class="fa fa-long-arrow-right"></i><a href="https://aws.amazon.com/"> https://aws.amazon.com/</a>
</p>
After you have signed up you can use the Instance Launch Wizard:</p>

<p class="lead">
<i class="fa fa-long-arrow-right"></i><a href="https://console.aws.amazon.com/ec2/v2/home?#LaunchInstanceWizard"> https://console.aws.amazon.com/ec2/v2/home?#LaunchInstanceWizard</a>
</p>

<p>Choose the 64 bit Ubuntu 12 LTS version (12.04.3 as of writing)
Click <strong>Configure Instance Details</strong><br>
Leave everything default and scroll to the bottom of the page<br>
Click <strong>Advanced Details</strong><br> 
Under user-data check <strong>As Text</strong>
<br><br>
Paste the following into the text box:
<pre>#include https://get.docker.io</pre>
<br></p>

<p class="lead">
This will install Docker while it is launching your instance.
</p>

<p>Click <strong>Next Add Storage</strong><br>
Leave everything default<br></p>

<p>Click <strong>Next Tag Instance</strong><br>
Change the <strong>Name</strong> value to Docker so that you can identify it from other instances<br></p>

<p>Click <strong>Next Configure Security Group</strong><br>
Select <strong>Create New Security Group</strong><br> 
Click <strong>Add Rule</strong> and open SSH using TCP on port 22 to your ip address (will auto populate)<br>
Click <strong>Add Rule</strong> and open HTTP using TCP on port 80 to all addresses 0.0.0.0/0<br>
Click <strong>Review and Launch</strong><br>
Click <strong>Launch</strong></p>

<p>Select <strong>Create New Keypair</strong><br>
Give the new keypair a name<br>
Click <strong>Download Key Pair</strong></p>

<p>Move the key to a secure location on your hard drive </p>

<p>Click <strong>launch instances</strong><br>
Click <strong>View Instances</strong></p>

<p><br>
<p class="lead">
You should see the Docker instance that was created in the EC2 dashboard. 
</p>
<br>
Wait until the instance has finished initializing<br>
Check the box next to the tag name<br>
Click <strong>connect</strong></p>

<p>Open up a terminal session<br> 
Navigate to the folder/directory that your key is located in<br>
In the terminal type:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>sudo chmod 400 your_keypair_name.pem
</code></pre></div>

<p>This makes the keypair file read-only<br></p>

<p><br>
Copy the details of the <strong>Connect</strong> dialog box into the terminal:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>sudo ssh -i your_keypair_name.pem ubuntu@54.200.30.10
</code></pre></div>

<p>(The keypair and ip address should be unique to your case, do not copy those details from above)</p>

<p><br>
<p class="lead">
You should now be running a shell session inside the Ubuntu Amazon Instance
</p></p>

<p>In the Terminal type:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>docker
</code></pre></div>

<p>To ensure that <strong>lxc-docker</strong> was installed</p>

<p><br>
<p class="lead">
We need to get Git!
</p></p>

<p>Install Git:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>sudo apt-get install git
</code></pre></div>

<p><br>
<p class="lead">
Pull Dockerfiles....
</p></p>

<p>Github user <u><a href="https://github.com/ricardoamaro">Ricardo Amaro</a></u> has been kind enough
to provide a DockerFile that pulls a base Ubuntu image and installs a LAMP stack, Drupal and all of its
dependencies, Drush and configures the web server and mysql database. 
<br></p>

<p>Do some homework and read up on <u><a href="http://docs.docker.io/en/latest/">Docker</a></u> 
and its <u><a href="http://docs.docker.io/en/latest/use/builder/">DockerFiles</a></u></p>

<p><br>
Clone the docker-drupal repository </p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>sudo git clone https://github.com/ricardoamaro/docker-drupal.git
<span class="nv">$ </span><span class="nb">cd </span>docker-drupal
<span class="nv">$ </span>sudo docker build -t ubuntu/drupal .
</code></pre></div>

<p><br>
Grab some <i class="fa fa-coffee fa-2x"></i> and wait for everything to install. </p>

<p><br>
<p class="lead">
Fire up the container...
</p></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>sudo docker run -d -p 80:80 -name TEST ubuntu/drupal 
</code></pre></div>

<p><code>-name TEST</code> will give the container a name so that you can call TEST instead of 
the long string of numbers Docker uses by default. 
<br></p>

<p><br>
Visit the public ip address that your Amazon instance is running on</p>

<p><br>
<p class="lead">
You should see a basic Drupal Bartik themed landing page
</p></p>

<p>Username: <strong>admin</strong><br>
Password: <strong>admin</strong>
<br></p>

<p>Go ahead and play around with your Drupal installation, add a theme, create a node, whatever you want to do.</p>

<p><br>
When you are finished head back to the Terminal and type:</p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>sudo docker stop TEST 
</code></pre></div>

<p><br>
This command will stop the container from running. If you navigate to your Amazon instance&#39;s ip address
you will notice that the web server is no longer running. <br>
When you wish to continue working in your containerized environment simply execute the run command
from a few steps ago and head back to your instance&#39;s public ip address.
<br></p>

<p>Dont forget to shutdown your Amazon micro instance when you are all finished:<br>
If you are still in the EC2 Instances Dashboard check the box next to the instance(s) that are in a running state.<br></p>

<p>Click <strong>Actions</strong><br>
Under <strong>Actions</strong> click <strong>Stop</strong> </p>

<p><br>
Obviously this is a very condensed tutorial and is only meant to help get you started. As you can
see Docker is a powerful development tool that bears some serious attention. q</p>

<p><br>
<p class="lead">
The rest is up to you!
</p></p>
<p>
    </p>	

<br>
<br>





          
          
</div>


  <div class="col-md-4">
    <h3>About Me</h3>

<p>Information Technology & Digital Media at a Chicago area library.</p>
<p>Veteran library professional transitioning into an information security concentration. 
Focusing on Network & Cloud Security, Malware Analysis, Digital Forensics, 
Linux Shellcode & Cyber Law. Hobbies include web and cloud development.</p> 

<p>100% self taught, self study. Advocate of MOOC's, OER's and open education.</p>


<h3>Blog roll</h3>
<a href="http://www.darknet.org.uk/">The Darknet</a><br>
<a href="http://blog.dynamoo.com/">Dynamoo's Blog</a><br>
<a href="http://blog.erratasec.com/">Errata Security</a><br>
<a href="http://blog.cryptographyengineering.com/">A Few Thoughts On Cryptographic Engineering</a><br>
<a href="http://www.forensicfocus.com/">Forensic Focus</a><br>
<a href="http://grugq.github.io/">Hacker OPSEC</a><br>
<a href="http://grugq.tumblr.com/">Hacker Tradecraft</a><br>
<a href="http://resources.infosecinstitute.com/">InfoSec Institute</a><br>
<a href="http://www.irongeek.com/">Irongeek</a><br>
<a href="http://krebsonsecurity.com/">Krebs on Security</a><br>
<a href="http://malwaremustdie.blogspot.com/">Malware Must Die</a><br>
<a href="http://packetstormsecurity.com/">Packet Storm</a><br>
<a href="http://www.scmagazine.com/">SC Magazine</a><br>
<a href="https://www.schneier.com/">Schneier on Security</a><br>
<a href="http://www.securitytube.net/">SecurityTube</a><br>
<a href="http://threatpost.com/">Threatpost</a><br>
<a href="http://uscyberlabs.com/blog/">USCyberLabs</a><br>

  </div>
</div>          
          
          
          
          
          
          
          
          
          
		    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
        	<script src="/js/bootstrap.js"></script>
        
       
<font color= "grey">
Copyright <span class="glyphicon glyphicon-copyright-mark"></span> 2014 p00gz.
</font>

  </body>
</html>  
